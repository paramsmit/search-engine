---
swagger: "2.0"
info: !php/object "O:8:\"stdClass\":4:{s:5:\"title\";s:21:\"Avi WafCRS Object API\";s:7:\"version\";s:6:\"18.2.4\";s:11:\"description\";s:57:\"CLI\n```\n-
  show wafcrs <key>\n- configure wafcrs <key>\n```\n\";s:7:\"contact\";O:8:\"stdClass\":3:{s:3:\"url\";s:34:\"https://avinetworks.com/contact-us\";s:4:\"name\";s:17:\"Avi
  Networks Inc.\";s:5:\"email\";s:23:\"support@avinetworks.com\";}}"
basePath: /api
paths:
  /wafcrs:
    post:
      security:
      - basicAuth: []
      produces:
      - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/WafCRS'
        401:
          description: log in failed
      parameters:
      - required: false
        type: string
        description: Avi Tenant Header
        in: header
        name: X-Avi-Tenant
      - required: false
        type: string
        description: Avi Tenant Header UUID
        in: header
        name: X-Avi-Tenant-UUID
      - required: true
        type: string
        description: The caller is required to set Avi Version Header to the expected
          version of configuration. The response from the controller will provide
          and accept data according to the specified version. The controller will
          reject POST and PUT requests where the data is not compatible with the specified
          version.
        in: header
        name: X-Avi-Version
      - required: false
        type: string
        description: Avi Controller may send back CSRF token in the response cookies.
          The caller should update the request headers with this token else controller
          will reject requests.
        in: header
        name: X-CSRFToken
      - required: true
        in: body
        description: WafCRS object creation
        name: body
        schema:
          $ref: '#/definitions/WafCRS'
      consumes:
      - application/json
    get:
      security:
      - basicAuth: []
      produces:
      - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/WafCRSApiResponse'
        401:
          description: log in failed
      parameters:
      - required: false
        type: string
        description: object name
        in: query
        name: name
      - in: query
        type: string
        description: Filter to request all objects that refers to another Avi resource.
          Its syntax is refers_to=<obj_type>:<obj_uuid>. Eg. get all virtual services
          referring to pool p1 will be refers_to=pool:pool_p1_uuid
        name: refers_to
      - in: query
        type: string
        description: Filter to request all objects that are referred by another Avi
          resource. Its syntax is referred_by=<obj_type>:<obj_uuid>. Eg. get all pools
          referred_by virtual service vs1 - referred_by=virtualservice:vs_vs1_uuid
        name: referred_by
      - in: query
        type: string
        description: List of fields to be returned for the resource. Some fields like
          name, URL, uuid etc. are always returned.
        name: fields
      - required: false
        type: boolean
        description: All the Avi REST reference URIs have a name suffix as URI#name.
          It is useful to get the referenced resource name without performing get
          on that object.
        in: query
        name: include_name
      - required: false
        type: boolean
        description: Default values are not set.
        in: query
        name: skip_default
      - in: query
        type: string
        description: It automatically returns additional dependent resources like
          runtime. Eg. join_subresources=runtime.
        name: join_subresources
      - required: false
        type: string
        description: Avi Tenant Header
        in: header
        name: X-Avi-Tenant
      - required: false
        type: string
        description: Avi Tenant Header UUID
        in: header
        name: X-Avi-Tenant-UUID
      - required: true
        type: string
        description: The caller is required to set Avi Version Header to the expected
          version of configuration. The response from the controller will provide
          and accept data according to the specified version. The controller will
          reject POST and PUT requests where the data is not compatible with the specified
          version.
        in: header
        name: X-Avi-Version
      - required: false
        type: string
        description: Avi Controller may send back CSRF token in the response cookies.
          The caller should update the request headers with this token else controller
          will reject requests.
        in: header
        name: X-CSRFToken
      consumes:
      - application/json
  /wafcrs/{uuid}:
    put:
      security:
      - basicAuth: []
      produces:
      - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/WafCRS'
        401:
          description: log in failed
      parameters:
      - required: false
        type: string
        description: object name
        in: query
        name: name
      - required: false
        type: string
        description: Avi Tenant Header
        in: header
        name: X-Avi-Tenant
      - required: false
        type: string
        description: Avi Tenant Header UUID
        in: header
        name: X-Avi-Tenant-UUID
      - required: true
        type: string
        description: The caller is required to set Avi Version Header to the expected
          version of configuration. The response from the controller will provide
          and accept data according to the specified version. The controller will
          reject POST and PUT requests where the data is not compatible with the specified
          version.
        in: header
        name: X-Avi-Version
      - required: false
        type: string
        description: Avi Controller may send back CSRF token in the response cookies.
          The caller should update the request headers with this token else controller
          will reject requests.
        in: header
        name: X-CSRFToken
      - required: true
        in: body
        description: WafCRS object creation
        name: body
        schema:
          $ref: '#/definitions/WafCRS'
      - required: true
        type: string
        description: UUID of the object to fetch
        in: path
        name: uuid
      consumes:
      - application/json
    get:
      security:
      - basicAuth: []
      produces:
      - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/WafCRS'
        401:
          description: log in failed
      parameters:
      - required: false
        type: string
        description: object name
        in: query
        name: name
      - required: false
        type: string
        description: Avi Tenant Header
        in: header
        name: X-Avi-Tenant
      - required: false
        type: string
        description: Avi Tenant Header UUID
        in: header
        name: X-Avi-Tenant-UUID
      - required: true
        type: string
        description: The caller is required to set Avi Version Header to the expected
          version of configuration. The response from the controller will provide
          and accept data according to the specified version. The controller will
          reject POST and PUT requests where the data is not compatible with the specified
          version.
        in: header
        name: X-Avi-Version
      - required: false
        type: string
        description: Avi Controller may send back CSRF token in the response cookies.
          The caller should update the request headers with this token else controller
          will reject requests.
        in: header
        name: X-CSRFToken
      - required: true
        type: string
        description: UUID of the object to fetch
        in: path
        name: uuid
      - in: query
        type: string
        description: List of fields to be returned for the resource. Some fields like
          name, URL, uuid etc. are always returned.
        name: fields
      - required: false
        type: boolean
        description: All the Avi REST reference URIs have a name suffix as URI#name.
          It is useful to get the referenced resource name without performing get
          on that object.
        in: query
        name: include_name
      - required: false
        type: boolean
        description: Default values are not set.
        in: query
        name: skip_default
      - in: query
        type: string
        description: It automatically returns additional dependent resources like
          runtime. Eg. join_subresources=runtime.
        name: join_subresources
      consumes:
      - application/json
    patch:
      security:
      - basicAuth: []
      produces:
      - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/WafCRS'
        401:
          description: log in failed
      parameters:
      - required: false
        type: string
        description: object name
        in: query
        name: name
      - required: false
        type: string
        description: Avi Tenant Header
        in: header
        name: X-Avi-Tenant
      - required: false
        type: string
        description: Avi Tenant Header UUID
        in: header
        name: X-Avi-Tenant-UUID
      - required: true
        type: string
        description: The caller is required to set Avi Version Header to the expected
          version of configuration. The response from the controller will provide
          and accept data according to the specified version. The controller will
          reject POST and PUT requests where the data is not compatible with the specified
          version.
        in: header
        name: X-Avi-Version
      - required: false
        type: string
        description: Avi Controller may send back CSRF token in the response cookies.
          The caller should update the request headers with this token else controller
          will reject requests.
        in: header
        name: X-CSRFToken
      - required: true
        in: body
        description: WafCRS object creation
        name: body
        schema:
          $ref: '#/definitions/WafCRS'
      - required: true
        type: string
        description: UUID of the object to fetch
        in: path
        name: uuid
      consumes:
      - application/json
    delete:
      security:
      - basicAuth: []
      produces:
      - application/json
      responses:
        204:
          description: object deleted
          schema:
            type: string
        404:
          description: not found
      parameters:
      - required: false
        type: string
        description: object name
        in: query
        name: name
      - required: false
        type: string
        description: Avi Tenant Header
        in: header
        name: X-Avi-Tenant
      - required: false
        type: string
        description: Avi Tenant Header UUID
        in: header
        name: X-Avi-Tenant-UUID
      - required: true
        type: string
        description: The caller is required to set Avi Version Header to the expected
          version of configuration. The response from the controller will provide
          and accept data according to the specified version. The controller will
          reject POST and PUT requests where the data is not compatible with the specified
          version.
        in: header
        name: X-Avi-Version
      - required: false
        type: string
        description: Avi Controller may send back CSRF token in the response cookies.
          The caller should update the request headers with this token else controller
          will reject requests.
        in: header
        name: X-CSRFToken
      - required: true
        type: string
        description: UUID of the object to fetch
        in: path
        name: uuid
      consumes:
      - application/json
definitions: !php/object "O:8:\"stdClass\":8:{s:17:\"WafCRSApiResponse\";O:8:\"stdClass\":3:{s:8:\"required\";a:2:{i:0;s:5:\"count\";i:1;s:7:\"results\";}s:4:\"type\";s:6:\"object\";s:10:\"properties\";O:8:\"stdClass\":2:{s:5:\"count\";O:8:\"stdClass\":2:{s:4:\"type\";s:7:\"integer\";s:6:\"format\";s:5:\"int32\";}s:7:\"results\";O:8:\"stdClass\":2:{s:5:\"items\";O:8:\"stdClass\":1:{s:4:\"$ref\";s:20:\"#/definitions/WafCRS\";}s:4:\"type\";s:5:\"array\";}}}s:12:\"IpAddrPrefix\";O:8:\"stdClass\":3:{s:8:\"required\";a:2:{i:0;s:7:\"ip_addr\";i:1;s:4:\"mask\";}s:4:\"type\";s:6:\"object\";s:10:\"properties\";O:8:\"stdClass\":2:{s:7:\"ip_addr\";O:8:\"stdClass\":2:{s:11:\"description\";s:100:\"Placeholder
  for description of property ip_addr of obj type IpAddrPrefix field type str  type
  object\";s:4:\"$ref\";s:20:\"#/definitions/IpAddr\";}s:4:\"mask\";O:8:\"stdClass\":3:{s:4:\"type\";s:7:\"integer\";s:11:\"description\";s:15:\"Number
  of mask.\";s:6:\"format\";s:5:\"int32\";}}}s:6:\"IpAddr\";O:8:\"stdClass\":3:{s:8:\"required\";a:2:{i:0;s:4:\"addr\";i:1;s:4:\"type\";}s:4:\"type\";s:6:\"object\";s:10:\"properties\";O:8:\"stdClass\":2:{s:4:\"type\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:28:\"
  Enum options - V4, DNS, V6.\";}s:4:\"addr\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:11:\"IP
  address.\";}}}s:12:\"WafRuleGroup\";O:8:\"stdClass\":3:{s:8:\"required\";a:3:{i:0;s:6:\"enable\";i:1;s:5:\"index\";i:2;s:4:\"name\";}s:4:\"type\";s:6:\"object\";s:10:\"properties\";O:8:\"stdClass\":6:{s:12:\"exclude_list\";O:8:\"stdClass\":3:{s:5:\"items\";O:8:\"stdClass\":1:{s:4:\"$ref\";s:33:\"#/definitions/WafExcludeListEntry\";}s:4:\"type\";s:5:\"array\";s:11:\"description\";s:232:\"Exclude
  list for the WAF rule group. The fields in the exclude list entry are logically
  and'ed to deduce the exclusion criteria. If there are multiple excludelist entries,
  it will be 'logical or' of them. Field introduced in 17.2.1.\";}s:6:\"enable\";O:8:\"stdClass\":3:{s:7:\"default\";b:1;s:4:\"type\";s:7:\"boolean\";s:11:\"description\";s:61:\"Enable
  or disable WAF Rule Group. Field introduced in 17.2.1.\";}s:4:\"name\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:28:\"
  Field introduced in 17.2.1.\";}s:5:\"index\";O:8:\"stdClass\":3:{s:4:\"type\";s:7:\"integer\";s:11:\"description\";s:28:\"
  Field introduced in 17.2.1.\";s:6:\"format\";s:5:\"int32\";}s:5:\"rules\";O:8:\"stdClass\":3:{s:5:\"items\";O:8:\"stdClass\":1:{s:4:\"$ref\";s:21:\"#/definitions/WafRule\";}s:4:\"type\";s:5:\"array\";s:11:\"description\";s:57:\"Rules
  as per Modsec language. Field introduced in 17.2.1.\";}s:15:\"force_detection\";O:8:\"stdClass\":2:{s:4:\"type\";s:7:\"boolean\";s:11:\"description\";s:296:\"When
  set to 'true', any rule in this group will not cause 'deny' or 'redirect' actions
  to run, even if WAF Policy is set to enforcement mode. The behavior would be as
  if this rule operated in detection mode regardless of WAF Policy setting. Field
  deprecated in 18.1.5. Field introduced in 18.1.4.\";}}}s:6:\"WafCRS\";O:8:\"stdClass\":3:{s:8:\"required\";a:5:{i:0;s:11:\"description\";i:1;s:9:\"integrity\";i:2;s:4:\"name\";i:3;s:12:\"release_date\";i:4;s:7:\"version\";}s:4:\"type\";s:6:\"object\";s:10:\"properties\";O:8:\"stdClass\":10:{s:14:\"_last_modified\";O:8:\"stdClass\":3:{s:8:\"readOnly\";b:1;s:4:\"type\";s:6:\"string\";s:11:\"description\";s:59:\"UNIX
  time since epoch in microseconds. Units(MICROSECONDS).\";}s:4:\"name\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:60:\"The
  name of this ruleset object. Field introduced in 18.2.1.\";}s:3:\"url\";O:8:\"stdClass\":3:{s:8:\"readOnly\";b:1;s:4:\"type\";s:6:\"string\";s:11:\"description\";s:3:\"url\";}s:12:\"release_date\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:91:\"The
  release date of this version in RFC 3339 / ISO 8601 format. Field introduced in
  18.1.1.\";}s:10:\"tenant_ref\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:110:\"Tenant
  that this object belongs to. It is a reference to an object of type Tenant. Field
  introduced in 18.2.1.\";}s:4:\"uuid\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:28:\"
  Field introduced in 18.1.1.\";}s:7:\"version\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:63:\"The
  version of this ruleset object. Field introduced in 18.1.1.\";}s:6:\"groups\";O:8:\"stdClass\":3:{s:5:\"items\";O:8:\"stdClass\":1:{s:4:\"$ref\";s:26:\"#/definitions/WafRuleGroup\";}s:4:\"type\";s:5:\"array\";s:11:\"description\";s:91:\"WAF
  Rules are sorted in groups based on their characterization. Field introduced in
  18.1.1.\";}s:9:\"integrity\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:55:\"Integrity
  protection value. Field introduced in 18.2.1.\";}s:11:\"description\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:64:\"A
  short description of this ruleset. Field introduced in 18.1.1.\";}}}s:19:\"WafExcludeListEntry\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"object\";s:10:\"properties\";O:8:\"stdClass\":5:{s:22:\"match_element_criteria\";O:8:\"stdClass\":2:{s:11:\"description\";s:64:\"Criteria
  for match_element matching. Field introduced in 18.2.2.\";s:4:\"$ref\";s:30:\"#/definitions/WafExclusionType\";}s:8:\"uri_path\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:62:\"URI
  Path to exclude for WAF rules. Field introduced in 17.2.1.\";}s:13:\"client_subnet\";O:8:\"stdClass\":2:{s:11:\"description\";s:70:\"Client
  IP Subnet to exclude for WAF rules. Field introduced in 17.2.1.\";s:4:\"$ref\";s:26:\"#/definitions/IpAddrPrefix\";}s:13:\"match_element\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:387:\"The
  match_element can be 'ARGS xxx', 'ARGS_GET xxx', 'ARGS_POST xxx', 'ARGS_NAMES xxx',
  'FILES xxx', 'QUERY_STRING', 'REQUEST_BASENAME', 'REQUEST_BODY', 'REQUEST_URI',
  'REQUEST_URI_RAW', 'REQUEST_COOKIES xxx', 'REQUEST_HEADERS xxx' or 'RESPONSE_HEADERS
  xxx'. These match_elements in the HTTP Transaction (if present) will be excluded
  when executing WAF Rules. Field introduced in 17.2.1.\";}s:18:\"uri_match_criteria\";O:8:\"stdClass\":2:{s:11:\"description\";s:54:\"Criteria
  for URI matching. Field introduced in 17.2.8.\";s:4:\"$ref\";s:30:\"#/definitions/WafExclusionType\";}}}s:16:\"WafExclusionType\";O:8:\"stdClass\":3:{s:8:\"required\";a:2:{i:0;s:10:\"match_case\";i:1;s:8:\"match_op\";}s:4:\"type\";s:6:\"object\";s:10:\"properties\";O:8:\"stdClass\":2:{s:10:\"match_case\";O:8:\"stdClass\":3:{s:7:\"default\";s:9:\"SENSITIVE\";s:4:\"type\";s:6:\"string\";s:11:\"description\";s:108:\"Case
  sensitivity to use for the matching. Enum options - SENSITIVE, INSENSITIVE. Field
  introduced in 17.2.8.\";}s:8:\"match_op\";O:8:\"stdClass\":3:{s:7:\"default\";s:6:\"EQUALS\";s:4:\"type\";s:6:\"string\";s:11:\"description\";s:245:\"String
  Operation to use for matching the Exclusion. Enum options - BEGINS_WITH, DOES_NOT_BEGIN_WITH,
  CONTAINS, DOES_NOT_CONTAIN, ENDS_WITH, DOES_NOT_END_WITH, EQUALS, DOES_NOT_EQUAL,
  REGEX_MATCH, REGEX_DOES_NOT_MATCH. Field introduced in 17.2.8.\";}}}s:7:\"WafRule\";O:8:\"stdClass\":3:{s:8:\"required\";a:3:{i:0;s:6:\"enable\";i:1;s:5:\"index\";i:2;s:4:\"rule\";}s:4:\"type\";s:6:\"object\";s:10:\"properties\";O:8:\"stdClass\":9:{s:12:\"exclude_list\";O:8:\"stdClass\":3:{s:5:\"items\";O:8:\"stdClass\":1:{s:4:\"$ref\";s:33:\"#/definitions/WafExcludeListEntry\";}s:4:\"type\";s:5:\"array\";s:11:\"description\";s:226:\"Exclude
  list for the WAF rule. The fields in the exclude list entry are logically and'ed
  to deduce the exclusion criteria. If there are multiple excludelist entries, it
  will be 'logical or' of them. Field introduced in 17.2.3.\";}s:6:\"enable\";O:8:\"stdClass\":3:{s:7:\"default\";b:1;s:4:\"type\";s:7:\"boolean\";s:11:\"description\";s:61:\"Enable
  or disable WAF Rule Group. Field introduced in 17.2.1.\";}s:4:\"name\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:67:\"User-friendly
  optional name for a rule. Field introduced in 17.2.1.\";}s:5:\"index\";O:8:\"stdClass\":3:{s:4:\"type\";s:7:\"integer\";s:11:\"description\";s:28:\"
  Field introduced in 17.2.1.\";s:6:\"format\";s:5:\"int32\";}s:4:\"tags\";O:8:\"stdClass\":3:{s:5:\"items\";O:8:\"stdClass\":1:{s:4:\"type\";s:6:\"string\";}s:4:\"type\";s:5:\"array\";s:11:\"description\";s:126:\"Tags
  for WAF rule as per Modsec language. They are extracted from the tag action in a
  ModSec rule. Field introduced in 18.1.3.\";}s:4:\"rule\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:56:\"Rule
  as per Modsec language. Field introduced in 17.2.1.\";}s:4:\"mode\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:251:\"WAF
  Rule mode. This can be detection or enforcement. If this is not set, the Policy
  mode is used. This only takes effect if the policy allows delegation. Enum options
  - WAF_MODE_DETECTION_ONLY, WAF_MODE_ENFORCEMENT. Field introduced in 18.1.5, 18.2.1.\";}s:15:\"force_detection\";O:8:\"stdClass\":2:{s:4:\"type\";s:7:\"boolean\";s:11:\"description\";s:283:\"When
  set to 'true', this rule will not cause 'deny' or 'redirect' actions to run, even
  if WAF Policy is set to enforcement mode. The behavior would be as if this rule
  operated in detection mode regardless of WAF Policy setting. Field deprecated in
  18.1.5. Field introduced in 18.1.4.\";}s:7:\"rule_id\";O:8:\"stdClass\":2:{s:4:\"type\";s:6:\"string\";s:11:\"description\";s:251:\"Identifier
  (id) for a rule per Modsec language. All SecRule and SecAction directives require
  an id. It is extracted from the id action in a ModSec rule. Rules within a single
  WAF Policy are required to have unique rule_ids. Field introduced in 17.2.2.\";}}}}"
...
